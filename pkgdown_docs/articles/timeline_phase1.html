<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GSOC 2020 Timeline Updates: Phase 1 • gfpopgui</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GSOC 2020 Timeline Updates: Phase 1">
<meta property="og:description" content="gfpopgui">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gfpopgui</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/timeline_cbp.html">GSOC 2020 Timeline Updates: CBP</a>
    </li>
    <li>
      <a href="../articles/timeline_phase1.html">GSOC 2020 Timeline Updates: Phase 1</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://github.com/julianstanley/gfpopgui/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="timeline_phase1_files/header-attrs-2.3/header-attrs.js"></script><script src="timeline_phase1_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GSOC 2020 Timeline Updates: Phase 1</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/julianstanley/gfpopgui/blob/master/vignettes/timeline_phase1.Rmd"><code>vignettes/timeline_phase1.Rmd</code></a></small>
      <div class="hidden name"><code>timeline_phase1.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Hi! I will update this section of the website as I progress through Google Summer of Code (GSOC) 2020. It will include my goals and progress for each week in the program, as well as notes about any observations or surprises.</p>
<p>This page specifically contains updates for Phase 1.</p>
</div>
<div id="phase-1" class="section level1">
<h1 class="hasAnchor">
<a href="#phase-1" class="anchor"></a>Phase 1</h1>
<div id="june-01---june-07" class="section level2">
<h2 class="hasAnchor">
<a href="#june-01---june-07" class="anchor"></a>June 01 - June 07</h2>
<div id="goals" class="section level3">
<h3 class="hasAnchor">
<a href="#goals" class="anchor"></a>Goals</h3>
<ul>
<li>Set up an RSelenium testing framework</li>
<li>Further modularize code</li>
</ul>
</div>
<div id="quick-reflection" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-reflection" class="anchor"></a>Quick Reflection</h3>
<p>This week was mostly about debugging testing. Although I did not have as much visible output of my work this week, I still think it was productive overall. I think that moving forward with this project will be much easier now that I’ve established a strong base of support.</p>
</div>
<div id="in-shiny-development-modules-are-important-and-useful" class="section level3">
<h3 class="hasAnchor">
<a href="#in-shiny-development-modules-are-important-and-useful" class="anchor"></a>In Shiny development, modules are important and useful</h3>
<p>Last week, I talked about using <code>source(file.path("R", "ui", "tab_home.R"), local = TRUE)$value</code>, etc. to seperate the different tabs of my application.</p>
<p>This week, that decision came back to bite me. The problem is that, in many shiny applications, all components of the application are stored in <code>inst/</code>, so all of those files are preserved when the package is built and distributed.</p>
<p>However, when building an app with <code>golem</code> (like I am), shiny logic is kept in the <code>R/</code> directory, which is modified when a package is built and distributed.</p>
<p>So, all that to say that the <code>source</code> approach was making my application break at weird times.</p>
<p>I should have built the different parts of my application as shiny modules in the first place. The <a href="https://mastering-shiny.org/scaling-modules.html">modules section in the mastering-shiny book</a> was very useful in learning more about how to make modules, and the reading was well worth the effort.</p>
</div>
</div>
<div id="rselenium-is-finicky-but-potentially-worth-it" class="section level2">
<h2 class="hasAnchor">
<a href="#rselenium-is-finicky-but-potentially-worth-it" class="anchor"></a>RSelenium is finicky, but potentially worth-it</h2>
<p>Here’s a guide to setting up RSelenium with Shiny:</p>
<ol style="list-style-type: decimal">
<li>Install the RSelenium R package: `install.packages(“RSelenium”)</li>
<li>Install Docker (on Ubuntu: <code>sudo apt install docker</code>)</li>
<li>Run a docker Selenium instance, making sure to set <code>--net=host</code>: docker run -d –net=host selenium/standalone-firefox&amp;</li>
<li>Open a Selenium instance from R:</li>
</ol>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">remDr</span> <span class="kw">&lt;-</span> <span class="fu">remoteDriver</span>(<span class="kw">remoteServerAddr</span> <span class="kw">=</span> <span class="st">"localhost"</span>, <span class="kw">port</span> <span class="kw">=</span> <span class="fl">4444</span>, <span class="kw">browser</span> <span class="kw">=</span> <span class="st">"firefox"</span>)
<span class="no">remDr</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">open</a></span>(<span class="kw">silent</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>At this point, if you navigate to <code>http://localhost:4444/wd/hub/static/resource/hub.html</code> in a browser, you should see a helpful Selenium interface.</p>
<ol start="5" style="list-style-type: decimal">
<li>Run an instance of your shiny app in the background on a known port:</li>
</ol>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span>(<span class="st">"${R_HOME}/bin/Rscript -e 'library(gfpopgui);options(shiny.port = 15123);run_app()' &amp;"</span>,
       <span class="kw">ignore.stdout</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
       <span class="kw">ignore.stderr</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<ol start="6" style="list-style-type: decimal">
<li>Use the <code>remDr</code> object to open the shiny app in a headless Selenium browser: <code>remDr$navigate(url = "http://127.0.0.1:15123")</code>.</li>
<li>Use the <code>remDr</code> object to interact with the app, or get information from it (e.g.: <code>appTitle &lt;- remDr$getTitle()[[1]]</code>). You can now use this information in tests.</li>
</ol>
<p>I personally put sets 4-7 within a testthat script. So, that script just requires that a Selenium instance is running. That means that my tests can run locally and also on Travis by including:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">services</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="at">  </span><span class="kw">-</span><span class="at"> docker</span></span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">before_install</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="at">  </span><span class="kw">-</span><span class="at"> docker pull selenium/standalone-firefox</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="at">  </span><span class="kw">-</span><span class="at"> docker run -d --net=host -p 127.0.0.1:4444:4444 selenium/standalone-firefox</span></span></code></pre></div>
<p>in my <code>.travis.yml</code>.</p>
<p>The only caveat is that running the shiny app in the background often takes a few seconds, so I include a <code><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep(10)</a></code> statement before running <code>remDr$navigate</code> to give the app time to reload.</p>
<p>We’ll see in the coming weeks if the effort to get this debugged was worth it!</p>
<div id="use-dtrenderdatatable-not-shinyrenderdatatable" class="section level3">
<h3 class="hasAnchor">
<a href="#use-dtrenderdatatable-not-shinyrenderdatatable" class="anchor"></a>Use DT::renderDataTable, not shiny::renderDataTable</h3>
<p>While modularizing my code this week, I noticed that I had some errors through Travis that I could not reproduce locally. If you’re reading this and are interested, <a href="https://community.rstudio.com/t/x-must-be-a-vector-travis-but-not-local/68717">here’s a link to my community.rstudio post about the problem</a>.</p>
<p>Ultimately, I was able to fix the problem by upgrading my R version, which was a few months out of date.</p>
<p>When I updated, I got errors in my <code><a href="https://rdrr.io/pkg/shiny/man/renderDataTable.html">shiny::renderDataTable</a></code> calls. Evidently <a href="https://community.rstudio.com/t/shiny-1-3-2-renderdatatable-cant-work-now/41935/2">others were also having the same problems in newer R versions</a> and the developers are moving from <code><a href="https://rdrr.io/pkg/shiny/man/renderDataTable.html">shiny::renderDataTable</a></code> to <code><a href="https://rdrr.io/pkg/DT/man/dataTableOutput.html">DT::renderDataTable</a></code>, and switching those functions (and having to tweak a bit to get them to work) fixed things up.</p>
<p>But, this episode convinced me that I needed to be more explicit about where my functions come from. So, I’ve completely removed <code>@import</code> statements in my ROxygen documentation comments and replaced them with <code>@importFrom</code> statements. This way, I am being explicit about the packages from which each of my function calls come.</p>
</div>
</div>
<div id="june-08---june-14" class="section level2">
<h2 class="hasAnchor">
<a href="#june-08---june-14" class="anchor"></a>June 08 - June 14</h2>
<div id="goals-1" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-1" class="anchor"></a>Goals</h3>
<p>This week is a feature development-heavy week. I would like to:</p>
<ul>
<li>Create a working, interactive graph</li>
<li>Improve the plotly visualization (namely: tooltip should only work on the segments/changepoints and give useful info)</li>
</ul>
</div>
<div id="quick-reflection-1" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-reflection-1" class="anchor"></a>Quick Reflection</h3>
<p>I’m writing this on June 15th (I’m late this week!), but last week went very well.</p>
<p>June 01-07 was difficult for me because it was mostly getting testing initially setup and debugged, which was frustrating because it felt like I wasn’t making significant progress.</p>
<p>This week, in contrast, felt like I was making a lot of progress because I was directly working on new app features. This short timeline post will cover a couple things that I learned while making two of those features.</p>
</div>
<div id="overlaying-segment-markers-on-a-plotly-visualization" class="section level3">
<h3 class="hasAnchor">
<a href="#overlaying-segment-markers-on-a-plotly-visualization" class="anchor"></a>Overlaying segment markers on a plotly visualization</h3>
<p>The <a href="https://arxiv.org/abs/2002.03646">2020 gfpop paper</a> provided me two different examples of what a changepoint plot should look like:</p>
<p><img src="https://github.com/julianstanley/gfpopgui/raw/master/docs/assets/june08_june14/changepoints_1.png" alt="changeplot plot 1"><img src="https://github.com/julianstanley/gfpopgui/raw/master/docs/assets/june08_june14/changepoints_2.png" alt="changeplot plot 2"></p>
<p>So, it was clear that I needed to have a base plot of the main data, and overlain bars to indicate the changepoints.</p>
<p>The main data was easy enough. The user provides that data in <code>gfpop_data$main_data</code>, so I can just plot the X and Y columns of that data.</p>
<p>Importantly, I want to disable tooltips with <code>hoverinfo = 'none'</code> so that they don’t interfere when the user tries to hover over a changepoint bar:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">base_plot</span> <span class="kw">&lt;-</span> <span class="fu">plot_ly</span>(<span class="no">gfpop_data</span>$<span class="no">main_data</span>, <span class="kw">x</span> <span class="kw">=</span> ~<span class="no">X</span>, <span class="kw">y</span> <span class="kw">=</span> ~<span class="no">Y</span>, <span class="kw">hoverinfo</span> <span class="kw">=</span> <span class="st">'none'</span>)</pre></body></html></div>
<p>Then comes the harder part. I have changepoint data (from running <code><a href="https://rdrr.io/pkg/gfpop/man/gfpop.html">gfpop::gfpop()</a></code> on <code>gfpop_data$main_data</code> and the user-provided graph), and I need to overlay that data on the plot.</p>
<p>Originally, I overlayed that data using the <code>geom_segment</code> layer, or the plotly equivalent <code>add_segments()</code>. That works well, but has a big downside: segments cannot have their own tooltips. I should post an issue on the plotly GitHub page to make sure that’s the case.</p>
<p>So, instead, I need to create many points along where the changepoint regions are supposed to go, and then connect them with a line, since a line can have a tooltip. I also will need a separate trace for segments (e.g. spans along the X axis without changepoints) and for the changepoints themselves, since they need to be two different colors.</p>
<p>I ended up writing a function that I am not super proud of called <code>add_changepoints</code>. It loops through each of the changepoints returned by <code><a href="https://rdrr.io/pkg/gfpop/man/gfpop.html">gfpop::gfpop</a></code> and creates a dataframe that includes many points and a description for each changepoint, adds that to an accumulator dataframe, and then uses that accumulator dataframe to draw lines. This just seems unnecessarily resource intensive and verbose for what I want to do, but here’s the code:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">add_changepoints</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">plotly_obj</span>, <span class="no">original_data</span>, <span class="no">changepoint_data</span>) {
  <span class="co"># Initialize plotly object to return</span>
  <span class="no">return_plotly</span> <span class="kw">&lt;-</span> <span class="no">plotly_obj</span> <span class="kw">%&gt;%</span>
    <span class="fu">hide_legend</span>()

  <span class="no">changepoint_annotations_regions</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(), <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(), <span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>())
  <span class="no">changepoint_annotations</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(), <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(), <span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>())

  <span class="no">changepoints</span> <span class="kw">&lt;-</span> <span class="no">changepoint_data</span>$<span class="no">changepoints</span>

  <span class="co"># Note: ds = dataspace, since changepoint data refers to indicates, not in dataspace</span>
  <span class="no">previous_changepoint</span> <span class="kw">&lt;-</span> <span class="fl">1</span>
  <span class="no">previous_changepoint_ds</span> <span class="kw">&lt;-</span> <span class="no">original_data</span>$<span class="no">X</span>[<span class="fl">1</span>]
  <span class="no">i</span> <span class="kw">&lt;-</span> <span class="fl">1</span>
  <span class="co"># Add each changepoint to the given plotly object</span>
  <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">changepoints</span>)) {
    <span class="no">changepoint</span> <span class="kw">&lt;-</span> <span class="no">changepoints</span>[<span class="no">i</span>]
    <span class="no">changepoint_ds</span> <span class="kw">&lt;-</span> <span class="no">original_data</span>$<span class="no">X</span>[<span class="no">changepoint</span>]

    <span class="co"># The region preceeding a changepoint, or between two changepoints</span>
    <span class="no">changeregion</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">previous_changepoint</span>, <span class="no">changepoint</span>)
    <span class="no">changeregion_ds</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">previous_changepoint_ds</span>,
      <span class="no">changepoint_ds</span>,
      <span class="kw">length.out</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">changeregion</span>)
    )

    <span class="no">changepoint_annotations_regions</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
      <span class="no">changepoint_annotations_regions</span>,
      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">changeregion_ds</span>, <span class="fl">NA</span>),
                 <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">changepoint_data</span>$<span class="no">parameters</span>[<span class="no">i</span>], <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">changeregion_ds</span>)), <span class="fl">NA</span>),
                 <span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(
                   <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(
                   <span class="st">"State: "</span>, <span class="no">changepoint_data</span>$<span class="no">states</span>[<span class="no">i</span>], <span class="st">"\n"</span>,
                   <span class="st">"Region mean: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">changepoint_data</span>$<span class="no">parameters</span>[<span class="no">i</span>], <span class="fl">2</span>), <span class="st">"\n"</span>,
                   <span class="st">"Next changepoint: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">changepoint_ds</span>, <span class="fl">2</span>)
                 ),
                 <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">changeregion_ds</span>)), <span class="fl">NA</span>)
      )
    )
    <span class="co"># If this isn't the first region, connect this region with the last</span>
    <span class="kw">if</span> (<span class="no">i</span> <span class="kw">&gt;</span> <span class="fl">1</span>) {
      <span class="no">changepoint_annotations</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(
        <span class="no">changepoint_annotations</span>,
        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
          <span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">previous_changepoint_ds</span>, <span class="fl">50</span>), <span class="fl">NA</span>),
          <span class="kw">y</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="no">changepoint_data</span>$<span class="no">parameters</span>[<span class="no">i</span> - <span class="fl">1</span>],
                                  <span class="no">changepoint_data</span>$<span class="no">parameters</span>[<span class="no">i</span>],
                                  <span class="kw">length.out</span> <span class="kw">=</span> <span class="fl">50</span>
          ), <span class="fl">NA</span>),
          <span class="kw">text</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"Changepoint #"</span>, <span class="no">i</span>-<span class="fl">1</span>, <span class="st">": "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="no">previous_changepoint_ds</span>, <span class="fl">2</span>)), <span class="fl">50</span>),
                   <span class="fl">NA</span>)
        )
      )
    }

    <span class="co"># Update the previous changepoints</span>
    <span class="no">previous_changepoint</span> <span class="kw">&lt;-</span> <span class="no">changepoint</span>
    <span class="no">previous_changepoint_ds</span> <span class="kw">&lt;-</span> <span class="no">changepoint_ds</span>
  }

  <span class="no">return_plotly</span> <span class="kw">%&gt;%</span>
    <span class="fu">add_lines</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">changepoint_annotations_regions</span>,
              <span class="kw">x</span> <span class="kw">=</span> ~<span class="no">x</span>,
              <span class="kw">y</span> <span class="kw">=</span> ~<span class="no">y</span>,
              <span class="kw">color</span> <span class="kw">=</span> ~<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="st">"#40B0A6"</span>),
              <span class="kw">hoverinfo</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">text</span> <span class="kw">=</span> ~<span class="no">text</span>,
              <span class="kw">connectgaps</span> <span class="kw">=</span> <span class="no">F</span>,
              <span class="kw">line</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7</span>)) <span class="kw">%&gt;%</span>
    <span class="fu">add_lines</span>(<span class="kw">data</span> <span class="kw">=</span> <span class="no">changepoint_annotations</span>,
              <span class="kw">x</span> <span class="kw">=</span> ~<span class="no">x</span>,
              <span class="kw">y</span> <span class="kw">=</span> ~<span class="no">y</span>,
              <span class="kw">color</span> <span class="kw">=</span> ~<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span>(<span class="st">"#E1BE6A"</span>),
              <span class="kw">hoverinfo</span> <span class="kw">=</span> <span class="st">"text"</span>, <span class="kw">text</span> <span class="kw">=</span> ~<span class="no">text</span>,
              <span class="kw">connectgaps</span> <span class="kw">=</span> <span class="no">F</span>,
              <span class="kw">line</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">width</span> <span class="kw">=</span> <span class="fl">7</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span>(<span class="kw">hovermode</span> <span class="kw">=</span> <span class="st">"x unified"</span>)
}</pre></body></html></div>
<p>And, in the app, it generates plots like this:</p>
<div class="figure">
<img src="https://github.com/julianstanley/gfpopgui/raw/master/docs/assets/june08_june14/changepoints_3.png" alt=""><p class="caption">changeplot plot 3</p>
</div>
<p>For the time being, this accomplishes what I need it to do–but I should come back to this later in the project.</p>
<p>In the meantime, I <a href="https://community.rstudio.com/t/tooltip-for-geom-segment-add-segments-in-plotly/69910">posted this on RStudio community</a>.</p>
</div>
</div>
<div id="monitoring-user-changes-in-visnetwork" class="section level2">
<h2 class="hasAnchor">
<a href="#monitoring-user-changes-in-visnetwork" class="anchor"></a>Monitoring user changes in visNetwork</h2>
<p>When a user edits a visNetwork plot, the data underlying the plot remains unchanged.</p>
<p>So, in the case of gfpopgui, where I want to take user’s visNetwork graph edits and use the resulting graph to estimate changepoints, I need additional code to watch for graph edits and edit the underlying graph data.</p>
<p>visNetwork provides that functionality by passing user edits in an object contained in <code>input${graph name}_graphChange</code>. So, in the case of gfpopgui, the graph name is <code>gfpopGraph</code>, so the input to observe is <code>input$gfpopGraph_graphChange</code>.</p>
<p>The <code>input$gfpopGraph_graphChange</code> object has a <code>cmd</code> entry that specifies the type of change. Then, in response to those different graphChange commands, I can edit the data:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">event</span> <span class="kw">&lt;-</span> <span class="no">input</span>$<span class="no">gfpopGraph_graphChange</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"editEdge"</span>) {
    <span class="co"># What happens when the user edits an edge?</span>
    <span class="co"># In this case, I used `mutate_cond`</span>
}

<span class="co">### Add Edge ---------------------------------------------------------------</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"addEdge"</span>) {
    <span class="co"># Add edge response</span>
}

<span class="co">### Delete Edge ------------------------------------------------------------</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"deleteElements"</span> <span class="kw">&amp;&amp;</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">event</span>$<span class="no">edges</span>) <span class="kw">&gt;</span> <span class="fl">0</span>)) {
    <span class="co"># When the user deletes elements, the resulting event has $edges and $nodes </span>
    <span class="co"># that are changed</span>
}

<span class="co">### Add Node ---------------------------------------------------------------</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"addNode"</span>) {
    <span class="co"># Add node response</span>
}

<span class="co">### Edit Node --------------------------------------------------------------</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"editNode"</span>) {
    <span class="co"># Edit node response</span>
}

<span class="co">### Delete Node ------------------------------------------------------------</span>
<span class="kw">if</span> (<span class="no">event</span>$<span class="no">cmd</span> <span class="kw">==</span> <span class="st">"deleteElements"</span> <span class="kw">&amp;&amp;</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">event</span>$<span class="no">nodes</span>) <span class="kw">&gt;</span> <span class="fl">0</span>)) {
    <span class="co"># Delete node response</span>
}</pre></body></html></div>
</div>
<div id="june-15---june-21" class="section level2">
<h2 class="hasAnchor">
<a href="#june-15---june-21" class="anchor"></a>June 15 - June 21</h2>
<div id="goals-2" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-2" class="anchor"></a>Goals</h3>
<p>While last week was a feature-heavy week, this one is more about stepping back, cleaning up, and testing.</p>
<p>My goals are to:</p>
<ul>
<li>Abstract and clean up code</li>
<li>Implement some more testing</li>
</ul>
</div>
<div id="quick-reflection-2" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-reflection-2" class="anchor"></a>Quick Reflection</h3>
<p>This week felt slower than last, but I learned a lot. First, the new <code>testServer</code> functionality in Shiny is really helpful–I’ll talk about that more below. Second, I have read more carefully about the <code>gfpop</code> package itself, and can work next week to put what I learned into the application.</p>
</div>
<div id="testserver" class="section level3">
<h3 class="hasAnchor">
<a href="#testserver" class="anchor"></a>testServer</h3>
<p>The new <code>testServer</code> functionality relies on a particular module structure that is implemented in the current Shiny version, 1.4, and will be recommended after 1.5 is released.</p>
<div id="background-new-module-structure" class="section level4">
<h4 class="hasAnchor">
<a href="#background-new-module-structure" class="anchor"></a>Background: new module structure</h4>
<p>In the old module structure, server modules were written as follows:</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># In the module.R file</span>
<span class="no">example_module_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
    <span class="co"># Server code here</span>
}</pre></body></html></div>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># In the server.R file</span>
<span class="no">app_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
    <span class="fu">callModule</span>(<span class="no">example_module_server</span>, <span class="st">"unique-id"</span>)
}</pre></body></html></div>
<p>In the new module structure, server modules are written a bit differently:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># In the module.R file</span>
<span class="no">example_module_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">id</span>) {
    <span class="fu">moduleServer</span>(
        <span class="no">id</span>,
        <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
    <span class="co"># Server code here</span>
    })
}</pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># In the server.R file</span>
<span class="no">app_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
    <span class="fu">example_module_server</span>(<span class="st">"unique-id"</span>)
}</pre></body></html></div>
<p>This new format is helpful because the <code>callModule</code> part of the old format is built-in to the module function–so, essentially, you have a <strong>single, self-contained</strong> server function, rather than a function that can only be called through <code>callModule</code>.</p>
<p><code>golem</code> still recommends/uses the old module format, so I submitted an <a href="https://github.com/ThinkR-open/golem/issues/455">issue on their repo</a> to remind them to update their recommendations once Shiny 1.5 is released.</p>
</div>
<div id="testing-overview" class="section level4">
<h4 class="hasAnchor">
<a href="#testing-overview" class="anchor"></a>Testing Overview</h4>
<p>The new <code>testModule</code> functionality relies on the new module structure, since it expects a single function to contain the whole server module.</p>
<p>It’s really great because it allows you to access all of the inputs inside of your reactive shiny objects. For example,</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shiny</span>)
<span class="no">example_module_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">id</span>) {
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html">moduleServer</a></span>(
    <span class="no">id</span>,
    <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
      <span class="no">myvals</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html">reactiveValues</a></span>(<span class="kw">example</span> <span class="kw">=</span> <span class="st">"Hello, world!"</span>)
    }
  )
}

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html">testServer</a></span>(<span class="no">example_module_server</span>, {
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">myvals</span>$<span class="no">example</span>)
})</pre></body></html></div>
<div class="sourceCode" id="cb12"><html><body><pre class="r">[1] "Hello, world!"</pre></body></html></div>
<p>It also allows you to set inputs:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shiny</span>)
<span class="no">example_module_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">id</span>) {
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html">moduleServer</a></span>(
    <span class="no">id</span>,
    <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
      <span class="no">my_func</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html">reactive</a></span>({
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">input</span>$<span class="no">my_input</span>)
      })
    }
  )
}

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html">testServer</a></span>(<span class="no">example_module_server</span>, {
  <span class="no">session</span>$<span class="fu">setInputs</span>(<span class="kw">my_input</span> <span class="kw">=</span> <span class="st">"This is my input!"</span>)
  <span class="fu">my_func</span>()
})</pre></body></html></div>
</div>
<div id="problems-testing" class="section level4">
<h4 class="hasAnchor">
<a href="#problems-testing" class="anchor"></a>Problems Testing</h4>
<p>One problem I’ve had is that I can’t use <code>testServer</code> to trigger click events directly:</p>
<p>This testServer code should print “Button was pressed”, but it doesn’t.]</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">shiny</span>)
<span class="no">example_module_server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">id</span>) {
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/moduleServer.html">moduleServer</a></span>(
    <span class="no">id</span>,
    <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">eventReactive</a></span>(<span class="no">input</span>$<span class="no">my_button</span>, {
        <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"Button was pressed"</span>)
      })
    }
  )
}

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html">testServer</a></span>(<span class="no">example_module_server</span>, {
  <span class="co"># my_button should already be NULL, but for good measure:</span>
  <span class="no">session</span>$<span class="fu">setInputs</span>(<span class="kw">my_button</span> <span class="kw">=</span> <span class="kw">NULL</span>)
  <span class="co"># This should be what happens when the button is pressed</span>
  <span class="no">session</span>$<span class="fu">setInputs</span>(<span class="kw">my_button</span> <span class="kw">=</span> <span class="fl">0</span>)
})</pre></body></html></div>
<p>Has no output. So, I commented on an <a href="https://github.com/rstudio/shiny/issues/2745">existing shiny issue</a> to hopefully have that fixed.</p>
</div>
</div>
</div>
<div id="further-features" class="section level2">
<h2 class="hasAnchor">
<a href="#further-features" class="anchor"></a>Further features</h2>
<p>That’s it for this week, but more information about this week’s progress is located in <a href="https://github.com/julianstanley/gfpopgui/issues">the issues tab of the gfpopgui repo</a>.</p>
</div>
<div id="june-22---june-28" class="section level2">
<h2 class="hasAnchor">
<a href="#june-22---june-28" class="anchor"></a>June 22 - June 28</h2>
<div id="goals-3" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-3" class="anchor"></a>Goals</h3>
<p>This week is mostly about testing</p>
<p>My goals are to:</p>
<ul>
<li>Better understand Selenium/SauceLabs testing</li>
<li>Finish off little feature issues</li>
</ul>
</div>
<div id="quick-reflection-3" class="section level3">
<h3 class="hasAnchor">
<a href="#quick-reflection-3" class="anchor"></a>Quick Reflection</h3>
<p>I felt much less productive this week than in previous weeks. A lot of the Selenium/web testing concepts are difficult and I got stuck/unmotivated at multiple points throughout the week. Still, I made some progress. I’ll plan to write a more extensive blog post about setting up RSelenium/SauceLabs towards the end of this internship period, so these are mostly notes to refresh my memory with that time comes.</p>
</div>
<div id="using-xpath-in-selenium" class="section level3">
<h3 class="hasAnchor">
<a href="#using-xpath-in-selenium" class="anchor"></a>Using XPath in Selenium</h3>
<p>Especially in a ShinyApp, many elements in the DOM can be difficult to find. For example: how do I access elements in a table from DataTables?</p>
<p>To make it easier to find elements in the DOM, Selenium allows elements to be specified by an “XML path”, or XPath.</p>
<p>XPath is super helpful and, luckily, RSelenium can take XPath parameters as arguments.</p>
<p>For more information on XPath, <a href="https://www.guru99.com/xpath-selenium.html">this tutorial is really helpful</a>.</p>
<p>But, in practice, I can generate the XPath I need using <a href="https://chrome.google.com/webstore/detail/katalon-recorder-selenium/ljdobmomdgdljniojadhoplhkpialdid?hl=en-US">Katalon Recorder Chrome extension</a>.</p>
<p>Katalon can recognize most of the elements in gfpopgui and give me the associated id or, if a simple id doesn’t exist, an XPath.</p>
<p>For example, the XPath of the first element in the first DataTable in gfpop gui is:</p>
<p><code>//table[@id='DataTables_Table_0']/tbody/tr/td[0]</code></p>
<p>So, to access that element with RSelenium, I can write:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">remDr</span>$<span class="fu">findElement</span>(<span class="st">"xpath"</span>, <span class="st">"//table[@id='DataTables_Table_0']/tbody/tr/td[0]"</span>)</pre></body></html></div>
<p>Or, if I want to recreate the entire DataTable:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu">data.table</span>(
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(
        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(
            <span class="no">remDr</span>$<span class="fu">findElements</span>(<span class="st">"xpath"</span>, <span class="st">"//table[@id='DataTables_Table_0']/tbody/tr/td"</span>),
            <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="no">x</span>$<span class="fu">getElementAttribute</span>(<span class="st">"innerHTML"</span>))
            ),
        <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">10</span>,
        <span class="kw">byrow</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
)</pre></body></html></div>
</div>
<div id="reporting-build-status-with-rselenium" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-build-status-with-rselenium" class="anchor"></a>Reporting build status with RSelenium</h3>
<p>SauceLabs keeps track of all Selenium tests, but it doesn’t by default know whether these tests passed or failed.</p>
<p>To report pass/fail status, you need to explicitly send pass/fail flags through Selenium.</p>
<p>I couldn’t find any RSelenium-specific examples on how to send those flags, but I noticed that I could by sending Javascript snippets through RSelenium. For example, here’s a helper function that I made for annotating Selenium jobs:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">submit_job_info</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">remDr</span>, <span class="no">build</span>, <span class="no">name</span>, <span class="no">result</span>) {
  <span class="kw">if</span> (!(<span class="no">result</span> <span class="kw">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"passed"</span>, <span class="st">"failed"</span>, <span class="st">"true"</span>, <span class="st">"false"</span>))) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Invalid result. Please use: passed, failed, true, or false"</span>)
  }

  <span class="no">remDr</span>$<span class="fu">executeScript</span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sauce:job-build="</span>, <span class="no">build</span>))
  <span class="no">remDr</span>$<span class="fu">executeScript</span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sauce:job-name="</span>, <span class="no">name</span>))
  <span class="no">remDr</span>$<span class="fu">executeScript</span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"sauce:job-result="</span>, <span class="no">result</span>))

}</pre></body></html></div>
<p>Here’s how I would use that function in a testthat script:</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">build_name</span> <span class="kw">&lt;-</span> <span class="no">buildName</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"my-test-build"</span>,
                    <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span>(), <span class="st">"%m-%d-%Y_%s"</span>))

<span class="fu">test_that</span>(<span class="st">"1 equals 1"</span>, {
    <span class="no">remDr</span>$<span class="fu"><a href="https://rdrr.io/r/base/connections.html">open</a></span>(<span class="kw">silent</span><span class="kw">=</span><span class="no">T</span>)
    <span class="no">test_case</span> <span class="kw">&lt;-</span> <span class="fl">1</span><span class="kw">==</span><span class="fl">1</span>
    <span class="fu">submit_job_info</span>(<span class="kw">remDr</span> <span class="kw">=</span> <span class="no">remDr</span>, <span class="kw">build</span> <span class="kw">=</span> <span class="no">build_name</span>,
        <span class="kw">name</span> <span class="kw">=</span> <span class="st">"1 equals 1"</span>, <span class="kw">result</span> <span class="kw">=</span> <span class="no">test_case</span>)
    <span class="fu">expect_equal</span>(<span class="fl">1</span>, <span class="fl">1</span>)
    <span class="co"># I could also do `expect_true(test_case)`, but that gives less</span>
    <span class="co"># informative error messages</span>
})</pre></body></html></div>
<p>That way, SauceLabs will bundle together all tests that come from <code>build_name</code> (so, the current run of the tests) and it will let me know whether those tests passed or failed.</p>
</div>
<div id="local-testing-with-saucelabs" class="section level3">
<h3 class="hasAnchor">
<a href="#local-testing-with-saucelabs" class="anchor"></a>Local testing with SauceLabs</h3>
<p>Right now, all of my testing is done through the online shinyapps.io server.</p>
<p>Maybe that is the way I’ll end up doing all the testing, but I’m worried that testing will drain the alloted time on the free-tier shinyapps.io.</p>
<p>But, SauceLabs does have a mechanism to test locally-running applications. And it also supports running applications in the background on Travis, and then running SauceLabs/Selenium tests within Travis. That would be super nifty (this way, for example, I could test whether new functionality in the app passes integration tests <em>before</em> pushing deploying that new functionality).</p>
<p>The <a href="https://docs.ropensci.org/RSelenium/articles/saucelabs.html">RSelenium docs</a> have a guide to running tests like that. On my local computer, I installed the <a href="https://wiki.saucelabs.com/display/DOCS/Sauce+Connect+Proxy">Sauce Connect Proxy</a>, followed the setup instructions, and ran the proxy.</p>
<p>The RSelenium docs were a bit unclear on how to connect, but you create remoteDriver on port 80 pointing to <code>ondemand.saucelabs.com</code> with your normal account credentials. Since the Sauce Connect Proxy is also connected to your account, Saucelabs knows to connect any <code>localhost</code> URL requests to your local computer via the Sauce Connect Proxy tunnel. And, if you’re running through Travis, you need a seperate tunnel id that corresponds to the travis build id.</p>
<p>This seemed to connect appropriately, but I had a big problem interacting with the Shiny app this way: I would get a WebSocket-related error that prevented me from accessing the application. Evidently WebSocket compatability was a problem in the past (~2014), but those issues have been fixed. So, I put in a SauceLabs support ticket to see if they can help.</p>
<details><p><summary> Here’s the ticket that I submitted: </summary></p>
<p>Hi SauceLabs support,</p>
<p>I’m hoping to get some help connecting to a local application. I’m still very new to this, so hopefully I’m just overlooking something.</p>
<p>I’m running my app locally on port 3000. I’m also running Sauce Connect with <code>-B all</code> (see output below).</p>
<p>My application works as-expected locally. SauceLabs is also able to connect to the publicly-hosted version of the application.</p>
<p>However, SauceLabs cannot load the localhost:3000-hosted version of the application through the SauceConnect tunnel. The app loads briefly, then greys out.</p>
<p>In the JS Console, the application complains that a WebSocket connection to <a href="ws://localhost:3000/websocket" class="uri">ws://localhost:3000/websocket</a> had a 404 failure.</p>
<p>My application is made with R Shiny. John Harrison, who wrote the main R package for connecting to Selenium, had a similar WebSocket error in 2014. His issue seemed to have been resolved by <code>--vm-version dev-varnish</code> and/or <code>-B all</code>. But neither of those options resolve my issue.</p>
<p>A live test showing my issue can be found here: <a href="https://app.saucelabs.com/tests/394fa9bf14f24ddf8e50214ae91dd7b3#1" class="uri">https://app.saucelabs.com/tests/394fa9bf14f24ddf8e50214ae91dd7b3#1</a></p>
<p>SauceConnect seems to be working well. Output:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1"></a><span class="ex">julian-ThinkPad-T460</span>:bin$ ./sc -u <span class="va">$SAUCE_USERNAME</span> -k <span class="va">$SAUCE_SECRET_KEY</span> -B all</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="ex">26</span> Jun 10:10:37 - Sauce Connect 4.6.2, build 5183 ad61662</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="ex">26</span> Jun 10:10:37 - REST: Using CA certificate bundle /etc/ssl/certs/ca-certificates.crt.</span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="ex">26</span> Jun 10:10:37 - REST: Using CA certificate verify path /etc/ssl/certs.</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="ex">26</span> Jun 10:10:37 - TUNNEL: Using CA certificate bundle /etc/ssl/certs/ca-certificates.crt.</span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="ex">26</span> Jun 10:10:37 - TUNNEL: Using CA certificate verify path /etc/ssl/certs.</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="ex">26</span> Jun 10:10:37 - Starting up<span class="kw">;</span> <span class="ex">pid</span> 1516379</span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="ex">26</span> Jun 10:10:37 - Command line arguments: ./sc -u julianstanley -k **** -B all</span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="ex">26</span> Jun 10:10:37 - Log file: /tmp/sc.log</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="ex">26</span> Jun 10:10:37 - Pid file: /tmp/sc_client.pid</span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="ex">26</span> Jun 10:10:37 - Timezone: EDT GMT offset: -4h</span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="ex">26</span> Jun 10:10:37 - Using no proxy for connecting to Sauce Labs REST API.</span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="ex">26</span> Jun 10:10:37 - Started scproxy on port 40155.</span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="ex">26</span> Jun 10:10:37 - Please wait for <span class="st">'you may start your tests'</span> to start your tests.</span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="ex">26</span> Jun 10:10:50 - Secure remote tunnel VM provisioned.</span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="ex">26</span> Jun 10:10:50 - Tunnel ID: 4fbe703952fc48ac88e601734020edcb</span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="ex">26</span> Jun 10:10:51 - Starting OCSP certificate check.</span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="ex">26</span> Jun 10:10:51 - Using no proxy for connecting to http://status.geotrust.com.</span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="ex">26</span> Jun 10:10:51 - Using no proxy for connecting to http://ocsp.digicert.com.</span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="ex">26</span> Jun 10:10:51 - Reached a trusted CA. Certificate chain is verified.</span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="ex">26</span> Jun 10:10:51 - Using no proxy for connecting to tunnel VM.</span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="ex">26</span> Jun 10:10:51 - Selenium listener disabled.</span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="ex">26</span> Jun 10:10:51 - Establishing secure TLS connection to tunnel...</span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="ex">26</span> Jun 10:10:53 - Sauce Connect is up, you may start your tests.</span></code></pre></div>
<p>And the log seems to be showing the same as the console:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">julian-ThinkPad-T460:~$ tail -100 /tmp/sc.log | grep localhost:3000 | grep socket -A10
2020-06-26 10:11:45.331 [1516379] PROXY 127.0.0.1:34558 (10.100.29.249) -&gt; GET http://localhost:3000/websocket/ (655 bytes)
2020-06-26 10:11:45.335 [1516379] PROXY 127.0.0.1:34558 (10.100.29.249) &lt;- 404 localhost:3000 (176 bytes)
2020-06-26 10:11:50.058 [1516379] PROXY 127.0.0.1:34568 (10.100.29.249) -&gt; GET http://localhost:3000/shared/shiny.min.js.map (548 bytes)
2020-06-26 10:11:50.071 [1516379] PROXY 127.0.0.1:34570 (10.100.29.249) -&gt; GET http://localhost:3000/shared/bootstrap/css/bootstrap.min.css.map (567 bytes)
2020-06-26 10:11:50.078 [1516379] PROXY 127.0.0.1:34568 (10.100.29.249) &lt;- 200 localhost:3000 (115012 bytes)
2020-06-26 10:11:50.087 [1516379] PROXY 127.0.0.1:34576 (10.100.29.249) -&gt; GET http://localhost:3000/crosstalk-1.1.0.1/js/crosstalk.min.js.map (566 bytes)
2020-06-26 10:11:50.097 [1516379] PROXY 127.0.0.1:34578 (10.100.29.249) -&gt; GET http://localhost:3000/vis-7.5.2/vis-network.min.js.map (557 bytes)
2020-06-26 10:11:50.102 [1516379] PROXY 127.0.0.1:34578 (10.100.29.249) &lt;- 404 localhost:3000 (116 bytes)
2020-06-26 10:11:50.107 [1516379] PROXY 127.0.0.1:34576 (10.100.29.249) &lt;- 200 localhost:3000 (50557 bytes)
2020-06-26 10:11:50.117 [1516379] PROXY 127.0.0.1:34570 (10.100.29.249) &lt;- 200 localhost:3000 (540654 bytes)</pre></body></html></div>
</details>
</div>
<div id="autodeployment-to-shinyapps-io" class="section level3">
<h3 class="hasAnchor">
<a href="#autodeployment-to-shinyapps-io" class="anchor"></a>Autodeployment to shinyapps.io</h3>
<p>On my todo list for a while has been continuously deploying the app to shinyapps.io via travis.</p>
<p>There were some weird things happening before. I think I’ve fixed those by just using <code>install_github('julianstanley/gfpop-gui')</code> <em>before</em> deploying, but after testing. Since the deployment only happens if the tests of the current build pass (and only on the master branch), then I can assume that the most up-to-date master branch is functional, install that, and use that up-to-date installation in the deployment.</p>
<p>Previously, I think I was using outdated versions of <code>gfpop-gui</code> in the deployment, which was causing the problems.</p>
<p>Right now deploying that way is putting the app at julianstanley.shinyapps.io/gfpop-gui instead of julianstanley.shinyapps.io/gfpopgui and I think that’s just because the github repository is <code>gfpop-gui</code> but the package name is <code>gfpopgui</code>. I need to pick one of these (the discrepency is there because <code>gfpop-gui</code> is not a valid R package name–they can’t have dashes).</p>
</div>
</div>
<div id="june-29---july-03" class="section level2">
<h2 class="hasAnchor">
<a href="#june-29---july-03" class="anchor"></a>June 29 - July 03</h2>
<div id="goals-4" class="section level3">
<h3 class="hasAnchor">
<a href="#goals-4" class="anchor"></a>Goals</h3>
<ul>
<li>Clean up basic app functionality for the end of Phase 1.</li>
</ul>
</div>
<div id="adding-save-and-load-buttons" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-save-and-load-buttons" class="anchor"></a>Adding ‘Save’ and ‘Load’ buttons</h3>
<p>In <code>gfpop</code>, users should be able to save and load their analyses, complete with their graphical constraint and main <code>gfpop</code> parameters.</p>
<p>Implementing this at a basic level was fairly straightforward: when a user presses “save”, all inputs that are necessary to reproduce the analysis should be saved in a <code><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html">reactiveValues()</a></code> list, with some user-supplied identifier.</p>
<p>Then, users can choose from saved identifiers to re-load saved analyses.</p>
<p>Practically, it looks something like this:</p>
<div id="initalize-reactive-values-list" class="section level4">
<h4 class="hasAnchor">
<a href="#initalize-reactive-values-list" class="anchor"></a>Initalize reactive values list</h4>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">saved_analyses</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html">reactiveValues</a></span>(
    <span class="kw">saved_full</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(),
    <span class="kw">saved_descriptions</span> <span class="kw">=</span> <span class="fu">data.table</span>()
)</pre></body></html></div>
<p>The idea here is that this data structure allows for more complex saving implemtations as well, if we end up wanting that. <code>saved_full</code> saves <em>all</em> data associated with a given save point, whereas <code>saved_descriptions</code> is a table that describes each entry in <code>saved_full</code>.</p>
<p>In this implementation, <code>saved_descriptions</code> just has identifiers, but we could also add more identifying information if that ends up being useful.</p>
</div>
<div id="add-button-to-save" class="section level4">
<h4 class="hasAnchor">
<a href="#add-button-to-save" class="anchor"></a>Add button to save</h4>
<p>Here, I need to use <code>reactiveValuesToList</code> because, if I literally saved gfpop_data in its reactiveValue form, it would continue to update as inputs change. But I want to save a snapshot, so I save it as a list.</p>
<div class="sourceCode" id="cb22"><html><body><pre class="r"># In UI
h2("Save"),
textInput(
    inputId = ns("saveId"),
    label = "Unique Save Name"
),
actionButton(
    inputId = ns("saveButton"),
    label = "Save Analysis"
)

# In Server
observeEvent(input$saveButton, 
    req(input$saveId)
    saveId &lt;- input$saveId

    # Make sure the save id is unique!
    if (saveId %in% names(saved_analyses$saved_full)) {
        shinyalert(paste0(
        "Error: '", saveId,
        "' already exists.\nIDs must be unique."
        ))

    # The saveId should be the key for the saved_full list.
    # And, for now (as mentioned in text above), `saved_descriptions`
    # is just the id, but could be built up later if necessary
    } else {
        saved_analyses$saved_full[[saveId]] &lt;- reactiveValuesToList(gfpop_data)
        saved_analyses$saved_descriptions &lt;- rbind(
        saved_analyses$saved_descriptions,
        data.table(id = input$saveId)
        )
    }

    # Clear the text input after saving
    updateTextInput(session, "saveId", value = "")
    })</pre></body></html></div>
</div>
<div id="add-ui-element-with-a-list-of-saved-environments" class="section level4">
<h4 class="hasAnchor">
<a href="#add-ui-element-with-a-list-of-saved-environments" class="anchor"></a>Add UI element with a list of saved environments</h4>
<div class="sourceCode" id="cb23"><html><body><pre class="r"># In UI
h2("Load"),
uiOutput(ns("uiLoadId"))

# In Server
output$uiLoadId &lt;- renderUI({
selectInput(ns("loadId"), "Select a previous analysis",
    choices = saved_analyses$saved_descriptions$id
)
})</pre></body></html></div>
</div>
<div id="add-a-loading-button" class="section level4">
<h4 class="hasAnchor">
<a href="#add-a-loading-button" class="anchor"></a>Add a loading button</h4>
<p>This part was a little tricky. First, to load the saved analyses, I need to coerce them into a reactive object, since I used <code>reactiveValuesToList</code> when saving. Then, I need to use a <code>&lt;&lt;-</code> to assign <code>gfpop_data</code> globally, not just within the observeEvent. Then, I use <code>do.call</code> to make each component of the saved list reactive.</p>
<p>In addition, overwriting <code>gfpop_data</code> does not update the graph (since there’s a manual button to update that graph). So, I use <code>updateNumericInput</code> to manually refresh the graph.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># In UI</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/actionButton.html">actionButton</a></span>(
        <span class="kw">inputId</span> <span class="kw">=</span> <span class="fu">ns</span>(<span class="st">"loadButton"</span>),
        <span class="kw">label</span> <span class="kw">=</span> <span class="st">"Load Analysis"</span>
    )

<span class="co"># In Server</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html">observeEvent</a></span>(<span class="no">input</span>$<span class="no">loadButton</span>, {
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/req.html">req</a></span>(<span class="no">input</span>$<span class="no">loadId</span>)
<span class="no">gfpop_data</span> <span class="kw">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(<span class="st">"reactiveValues"</span>, <span class="no">saved_analyses</span>$<span class="no">saved_full</span><span class="kw">[[</span><span class="no">input</span>$<span class="no">loadId</span>]])

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/updateNumericInput.html">updateNumericInput</a></span>(
    <span class="kw">session</span> <span class="kw">=</span> <span class="no">session</span>, <span class="kw">inputId</span> <span class="kw">=</span> <span class="st">"graph_refresh_helper"</span>,
    <span class="kw">value</span> <span class="kw">=</span> <span class="no">input</span>$<span class="no">graph_refresh_helper</span> + <span class="fl">1</span>
)
})</pre></body></html></div>
<p>Now, all together, users can load and save data!</p>
</div>
</div>
<div id="downloading-and-loading--rdata" class="section level3">
<h3 class="hasAnchor">
<a href="#downloading-and-loading--rdata" class="anchor"></a>Downloading and loading .Rdata</h3>
<p>This is simple, but was tricky to figure out how to do in the first place.</p>
<p>I wanted users to be able to download and upload .Rdata files with complete analyses.</p>
<p>To upload:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"># input$completed_analysis is defined above, that's the input 
# where users can upload their .Rdata file
rdata_name &lt;- load(input$completed_analysis$datapath)

# Use mget to load rdata_name into a variable
gfpop_data_list &lt;- mget(rdata_name, environment())

# The .Rdata contains a list, so go over each element in that list
# and add it to `gfpop_data`
# Since gfpop_data is already defined as a reactiveValues object, no
# need to coerse list items into reactive values: shiny takes care of that.
lapply(names(gfpop_data_list[[1]]), 
           function(x) gfpop_data[[x]] &lt;- gfpop_data_list[[1]][[x]])
  })</pre></body></html></div>
<p>To download:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># Just save gfpop_data as a list</span>
<span class="no">output</span>$<span class="no">downloadData</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/downloadHandler.html">downloadHandler</a></span>(
    <span class="kw">filename</span> <span class="kw">=</span> <span class="kw">function</span>() <span class="st">"gfpopgui_data.Rdata"</span>,
    <span class="kw">content</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">file</span>) {
        <span class="no">gfpop_data_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveValuesToList.html">reactiveValuesToList</a></span>(<span class="no">gfpop_data</span>, <span class="kw">all.names</span><span class="kw">=</span><span class="no">T</span>)
        <span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="no">gfpop_data_list</span>, <span class="kw">file</span> <span class="kw">=</span> <span class="no">file</span>)
    }
)</pre></body></html></div>
</div>
<div id="converting-a-graph-dataframe-to-r-code" class="section level3">
<h3 class="hasAnchor">
<a href="#converting-a-graph-dataframe-to-r-code" class="anchor"></a>Converting a graph dataframe to R code</h3>
<p>I still need to work on this more. For now, I just take each column in a gfpop graph dataframe and make it into an argument in the <code><a href="https://rdrr.io/pkg/gfpop/man/Edge.html">gfpop::Edge()</a></code> function.</p>
<p>This method works for most simple graphs, but doesn’t consider things like “Node” columns, etc.</p>
<p>So, to format an individual row in a graph dataframe:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co">#' Takes in a row from a graph dataframe, returns that row formatted as R code</span>
<span class="co">#' @param edge_df One row from a gfpop::graph() graph df, with column names</span>
<span class="co">#' @returns a string corresponding to the code that, when run, produces the </span>
<span class="co">#' given edge</span>
<span class="co">#' @examples </span>
<span class="co">#' graph &lt;- gfpop::graph(type = "std")</span>
<span class="co">#' format_edge(graph[1,])</span>
<span class="co">#' @export</span>
<span class="no">format_edge</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">edge_df</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"gfpop::Edge(state1 = '"</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"state1"</span>]], <span class="st">"'"</span>,
         <span class="st">", state2 = '"</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"state2"</span>]], <span class="st">"'"</span>,
         <span class="st">", type = '"</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"type"</span>]], <span class="st">"'"</span>,
         <span class="st">", gap = "</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"parameter"</span>]],
         <span class="st">", penalty = "</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"penalty"</span>]],
         <span class="st">", K = "</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"K"</span>]],
         <span class="st">", a = "</span>, <span class="no">edge_df</span><span class="kw">[[</span><span class="st">"a"</span>]],
         <span class="st">")"</span>)
}</pre></body></html></div>
<p>And then, to wrap each row together:</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="co">#' Takes in a graph dataframe, returns the graph formatted as R code</span>
<span class="co">#' @param graph A graph df, like that returned by gfpop::graph()</span>
<span class="co">#' @returns a string corresponding to the code that, when run, produces the</span>
<span class="co">#' given graph</span>
<span class="co">#' @examples </span>
<span class="co">#' graph &lt;- gfpop::graph(type = "std")</span>
<span class="co">#' graph_to_R_code(graph)</span>
<span class="co">#' @export</span>
<span class="no">graph_to_R_code</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">graph</span>) {
  <span class="no">valid_colnames</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"state1"</span>, <span class="st">"state2"</span>,
                      <span class="st">"type"</span>, <span class="st">"parameter"</span>,
                      <span class="st">"penalty"</span>, <span class="st">"K"</span>, <span class="st">"a"</span>,
                      <span class="st">"min"</span>, <span class="st">"max"</span>)
  <span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">graph</span>) <span class="kw">==</span> <span class="no">valid_colnames</span>)) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Invalid column names. Is this a dataframe returned from gfpop::graph?"</span>)
  }

  <span class="no">return_command</span> <span class="kw">&lt;-</span> <span class="st">"gfpop::graph(\n"</span>

  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span>(<span class="no">graph</span>, <span class="fl">1</span>, <span class="kw">function</span>(<span class="no">x</span>) {
    <span class="no">return_command</span> <span class="kw">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">return_command</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"    "</span>,
                                                     <span class="fu"><a href="../reference/format_edge.html">format_edge</a></span>(<span class="no">x</span>), <span class="st">",\n"</span>))
  })

  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span>(<span class="no">return_command</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span>(<span class="no">return_command</span>) - <span class="fl">2</span>), <span class="st">"\n)"</span>)
}</pre></body></html></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julian Stanley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
